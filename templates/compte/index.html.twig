{% extends 'base_agence.html.twig' %}

{# titre de le page#}
{% block title %}Banektek - Agent Menu{% endblock %}
{# activer sidebar elements (tnajm tfasakh zeydin li mouch active)#} 
{% block assistant_active %}{% endblock %}
{% block gestion_clients_active %}{% endblock %}
{% block gestion_comptes_active %}active{% endblock %}
{% block gestion_credits_active %}{% endblock %}
{% block gestion_agence_active %}{% endblock %}
{% block gestion_agents_active %}{% endblock %}
{% block gestion_operations_active %}{% endblock %}
{% block gestion_reclamations_active %}{% endblock %}
{% block gestion_agences_active %}{% endblock %}
{% block gestion_convertisseur_active %}{% endblock %}
{% block gestion_articles_active %}{% endblock %}
{% block gestion_cartes_active %}{% endblock %}
{# photos#}

{% block photo %}src="../{{agent_connecter.photo}}"{% endblock %}
{% block photo1 %}src="../{{agent_connecter.photo}}"{% endblock %}
{% block photo2 %}src="../{{agent_connecter.photo}}"{% endblock %}
{# agent-username#}
{% block username %}{{agent_connecter.nom}}{% endblock %}
{% block username2 %}{{agent_connecter.nom}}{% endblock %}
{% block username3 %}{{agent_connecter.nom}}{% endblock %}

{% block gestion %}Gestion des comptes{% endblock %}
{% block gestion2 %}Gestion des comptes{% endblock %}

{#mon code#}
{% block my_interface %} 
<!-- contenu de la page -->

<div class="container">
    <nav class="menu">
        <ul class="main-menu">
        <li id="ajouter"><i class="fa fa-plus"></i>Ajouter</li>
           
            <li class="active"><i class="fa fa-user"></i>Liste des comptes</li>
        </ul>
    </nav>

    <article>
    <div class="row">
				<div class="col-md-12">
                <div class="box box-danger">
                <div class="box-header"><div class="row">
            <div class="col-md-6">
<h3 class="box-title">les comptes</h3>            </div>
            <div class="col-md-6">
                <div class="input-group">
                    <input type="text" id="searchInput" class="form-control" placeholder="Search...">
                    <span class="input-group-btn">
                        <button type="button" id="search-btn" class="btn btn-flat">
                            <i class="fa fa-search" style="color:#003883"></i>
                        </button>
                    </span>
                </div>
            </div>
        </div></div>
					<div class="table-wrap">
						<table class="table table-responsive-xl" id="clients-table">
        <thead>
            <tr>
             <th>Numéro de compte</th>
              
                <th>Type</th>
                <th>Etat</th>
                <th>Solde</th>
                <th>Date_creation</th>
                 <th>Titulaire</th>
                <th>Actions</th>
            </tr>
            
        </thead>
        <tbody>
        {% for compte in comptes %}
            <tr>
                
<td>
<a href="#" style="" data-toggle="modal" data-target="#modal-{{ compte.id }}">
  <span style="color:black;font-size:13px; ">{{ compte.rib }}</span>
</a>

</td>
                <td>{{ compte.type }}</td>
                 <td>{{ compte.etat }}</td>
                <td>{{ compte.solde }}</td>
                <td>{{ compte.dateCreation|date('Y-m-d H:i:s')  }}</td>
                 <td style="color:black;font-size:14px;">
                 <a href="#" style="" data-toggle="modal" data-target="#modal-titulaire-{{ compte.id }}">

   {{ compte.getIdUser.getNom ~ " " ~ compte.getIdUser.getPrenom }}

        <small>(C.I.N:{{ compte.getIdUser.getCin }})
      </small>
      </a>
      </div>
    </td> 
                {#<td>{{ compte.dateFermeture ? compte.dateFermeture|date('Y-m-d H:i:s') : '' }}</td>#}
               
                
                <td>
 <div class="col-md-6" style="width:25%">
<button class="bin-button" data-toggle="modal" data-target="#modal-sup-{{ compte.id }}">
  <svg
    class="bin-top"
    viewBox="0 0 39 7"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <line y1="5" x2="39" y2="5" stroke="white" stroke-width="4"></line>
    <line
      x1="12"
      y1="1.5"
      x2="26.0357"
      y2="1.5"
      stroke="white"
      stroke-width="3"
    ></line>
  </svg>
  <svg
    class="bin-bottom"
    viewBox="0 0 33 39"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <mask id="path-1-inside-1_8_19" fill="white">
      <path
        d="M0 0H33V35C33 37.2091 31.2091 39 29 39H4C1.79086 39 0 37.2091 0 35V0Z"
      ></path>
    </mask>
    <path
      d="M0 0H33H0ZM37 35C37 39.4183 33.4183 43 29 43H4C-0.418278 43 -4 39.4183 -4 35H4H29H37ZM4 43C-0.418278 43 -4 39.4183 -4 35V0H4V35V43ZM37 0V35C37 39.4183 33.4183 43 29 43V35V0H37Z"
      fill="white"
      mask="url(#path-1-inside-1_8_19)"
    ></path>
    <path d="M12 6L12 29" stroke="white" stroke-width="4"></path>
    <path d="M21 6V29" stroke="white" stroke-width="4"></path>
  </svg>
</button>

    </div>                   {# <a href="{{ path('app_compte_edit', {'id': compte.id}) }}">edit</a>#}
                </td>
                
            </tr>
        {% else %}
            <tr>
                <td colspan="8">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>


{# -------------------------------------------------------------------- #}
   
                  

                 

{% endblock %}












  {% block modals %}
    <!-- Modal -->
{% for compte in comptes %}

<div class="modal fade" id="modal-sup-{{ compte.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form method="post" action="{{ path('app_compte_delete', {'id': compte.id}) }}">
                <div class="card2">
                    <div class="card2-content  text-center">
    <p class="card2-heading">Êtes-vous sûr de vouloir supprimer ce compte ?</p>
    <p class="card2-description">
        <strong>Numero de compte :</strong> {{ compte.rib }}<br>
        <strong>Titulaire :</strong> {{ compte.idUser.nom ~ compte.idUser.prenom ~ " ( C.I.N : " ~ compte.idUser.cin ~ " ) "}}<br>
        <strong>Agence :</strong> {{ compte.idAgence.nom }}<br>
        <!-- Ajoutez d'autres informations du compte selon vos besoins -->
    </p>
</div>

                    <div class="card2-button-wrapper">
                        <button class="card2-button secondary" data-dismiss="modal">Annuler</button>
                        <button class="card2-button primary">Confirmer la Suppression</button>
                    </div>
                </div>
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ compte.id) }}">
            </form>
        </div>
    </div>
</div>
{# -------------------------------------------------------------------- #}
    {% set form = forms[loop.index0] %}

    <div class="modal fade" id="modal-{{compte.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
      <div class="box-header">
                    <h3 class="box-title">Formulaire De Modification / Affichage</h3>
                </div>                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true"><i style="color:red; font-size: 20px;" class="fa fa-close"></i></span>
                    </button>
                </div>
                <div class="modal-body">
                    {{ include('compte/_form_edit.html.twig', {'button_label': 'Update'}) }}
                
                  

                    <!-- Formulaire pour la modification du compte -->
                    
                </div>
                <div class="modal-footer">
                     <div class="alert alert-warning" role="alert">
                        <strong>Attention :</strong> La modification des informations du compte est irréversible. Assurez-vous de vérifier attentivement avant de procéder.
                    </div>
                </div>
            </div>
        </div>
    </div>



    
{% endfor %}
{% for compte in comptes %}
<!-- Modal -->
<div class="modal fade" id="modal-titulaire-{{ compte.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form method="post" action="">
                <div class="card2">
                    <div class="card2-content  text-center">
    <p class="card2-heading">Client : {{compte.getIdAgence.nom}}</p>
    <p class="card2-description">
        <strong>Nom et Prenom :</strong> {{ compte.getIdUser.getNom ~ " " ~ compte.getIdUser.getPrenom }}<br>
        <strong>Numero CIN :</strong> {{ compte.getIdUser.getCin }}<br>
        <strong>Adresse :</strong> {{ compte.getIdUser.adresse }}<br>
        <!-- Ajoutez d'autres informations du client selon vos besoins -->
    </p>
</div>

                    <div class="card2-button-wrapper">
                        <button class="card2-button secondary" data-dismiss="modal">Annuler</button>
                        <button class="card2-button" style="background-color:#367fa9;">Effectuer Virement</button>
                        <button class="card2-button" style="background-color:#367fa9;">Effectuer Versement</button>
                        <button class="card2-button" style="background-color:#367fa9;">Effectuer Retrait</button>
                    </div>
                </div>
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ compte.id) }}">
            </form>
        </div>
    </div>
</div>
{% endfor %}
{% endblock %}
{% block autre_script%}
<script>  // Récupérer l'élément <li> par son ID
  var liAjouter = document.getElementById("ajouter");

  // Ajouter un gestionnaire d'événements de clic
  liAjouter.addEventListener("click", function() {
    // Rediriger l'utilisateur vers admin.php
    window.location.href = "{{ ('new') }}";
  });</script>


    <script>
    function toggleAccess(element,clientId) {
        var isChecked = element.querySelector('input').checked;
        var path = isChecked ? "{{ path('client_activer', {'id': 'clientId'}) }}" : "{{ path('client_desactiver', {'id': 'clientId'}) }}";
        window.location.href = path.replace('clientId', clientId);
    }
</script>

{% endblock %}
