

{% extends 'base_agence.html.twig' %}

{# titre de le page#}
{% block title %}Banektek - Agent Menu{% endblock %}
{# activer sidebar elements (tnajm tfasakh zeydin li mouch active)#} 
{% block assistant_active %}{% endblock %}
{% block gestion_clients_active %}{% endblock %}
{% block gestion_comptes_active %}{% endblock %}
{% block gestion_credits_active %}active{% endblock %}
{% block gestion_agence_active %}{% endblock %}
{% block gestion_agents_active %}{% endblock %}
{% block gestion_operations_active %}{% endblock %}
{% block gestion_reclamations_active %}{% endblock %}
{% block gestion_agences_active %}{% endblock %}
{% block gestion_convertisseur_active %}{% endblock %}
{% block gestion_articles_active %}{% endblock %}
{% block gestion_cartes_active %}{% endblock %}
{# photos#}

{% block photo %}src="../dist/img/user2-160x160.jpg"{% endblock %}
{% block photo1 %}src="../dist/img/user2-160x160.jpg"{% endblock %}
{% block photo2 %}src="../dist/img/user2-160x160.jpg"{% endblock %}
{# agent-username#}
{% block username %}Hamza Nasr{% endblock %}
{% block username2 %}Hamza Nasr{% endblock %}
{% block username3 %}Hamza Nasr{% endblock %}

{% block gestion %}Gestion des comptes{% endblock %}
{% block gestion2 %}Gestion des comptes{% endblock %}
{% block autre_stylesheet %}
  <style>
  .Btn2 {
  width: 130px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color:green;
  border: none;
  color: white;
  font-weight: 600;
  gap: 8px;
  cursor: pointer;
  box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.103);
  position: relative;
  overflow: hidden;
  transition-duration: .3s;
}

.svgIcon {
  width: 16px;
}

.svgIcon path {
  fill: white;
}

.Btn2::before {
  width: 130px;
  height: 130px;
  position: absolute;
  content: "";
  background-color: white;
  border-radius: 50%;
  left: -100%;
  top: 0;
  background-color: purple!important;
  transition-duration: .3s;
  mix-blend-mode: difference;
}

.Btn2:hover::before {
  transition-duration: .3s;
  transform: translate(100%,-50%);
  border-radius: 0;
    background-color: purple!important;
}

.Btn2:active {
  transform: translate(5px,5px);
  transition-duration: .3s;
    background-color: purple!important;
}</style>
{% endblock %}
{#mon code#}
{% block my_interface %} 
<div class="container">
    <nav class="menu">
        <ul class="main-menu">
        <li id="ajouter"><i class="fa fa-plus"></i>Ajouter</li>
           
            <li class="active"><i class="fa fa-user"></i>Liste</li>
        </ul>
    </nav>

    <article>
    <div class="row">
				<div class="col-md-12">
                <div class="box box-danger">
                <div class="box-header"><div class="row">
            <div class="col-md-6">
<h3 class="box-title">Liste des credits</h3> </div>
            <div class="col-md-6">
                <div class="input-group">
                    <input type="text" id="searchInput" class="form-control" placeholder="Search...">
                    <span class="input-group-btn">
                        <button type="button" id="search-btn" class="btn btn-flat">
                            <i class="fa fa-search" style="color:#003883"></i>
                        </button>
                    </span>
                </div>
            </div>
        </div></div>
					<div class="table-wrap">
						<table class="table table-responsive-xl" id="clients-table">
						  <thead>
          
						    <tr>
                <th>Compte</th>
                <th>Financement total</th>
                <th>Nombre d'echeances restant</th>
                <th>Montant Echeance</th>
                <th>Etat</th>
                <th>Partie Payée (%)</th>
                <th>Liste d'echeances</th>

						    </tr>
						  </thead>
						  <tbody >
         {% for credit in credits %}
  <tr>
  
    <td>
              <div class="pl-3 email">
<a href="#" style="" data-toggle="modal" data-target="#modal-{{ credit.id }}">
  <span style="color:black;font-size:13px; ">{{"Titulaire : " ~ credit.getIdCompte.getIdUser.getNom ~" " ~ credit.getIdCompte.getIdUser.getPrenom}}</span>
</a>
        <span>N° Compte:{{ credit.getIdCompte.rib}}
      </span>
      </div>
    
    </td>
    {#<td>{{credit.montant}}</td>#}
    {#<td>{{credit.getApportPropre}}</td>#}
    <td class="column-centered">{{credit.montant-credit.getApportPropre}}</td>
   {# <td>{{credit.type}}</td>#}
    {#<td>{{credit.duree}}</td>#}
    {#<td>{{credit.getDateDebut.format('Y-m-d')}}</td>#}
     {#<td>{{credit.getDateEcheance}}</td>#}
  <td class="column-centered">{{credit.getNbEcheancesRestants}}</td> 
         <td class="column-centered" >{{credit.getMontantEcheance}}</td>
     <td class="status colum-centered">
{% if credit.etat == "en cours" %}
    <span class="active">En cours</span>
{% else %}
    <span class="waiting">Suspendu  </span>
{% endif %}

    </td>
      <!-- avancement -->
   <td class="column-centered">
      <div class="half-arc" style="--percentage:75%;">
        <span class="label" style="margin-top:20px;">75%</span>
      </div>
    </td>
     <td class="column-centered">
     
    <div class="col-md-6" >
<button class="bin-button" data-toggle="modal" data-target="#modal-sup-{{ credit.id }}">
  <svg
    class="bin-top"
    viewBox="0 0 39 7"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <line y1="5" x2="39" y2="5" stroke="white" stroke-width="4"></line>
    <line
      x1="12"
      y1="1.5"
      x2="26.0357"
      y2="1.5"
      stroke="white"
      stroke-width="3"
    ></line>
  </svg>
  <svg
    class="bin-bottom"
    viewBox="0 0 33 39"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <mask id="path-1-inside-1_8_19" fill="white">
      <path
        d="M0 0H33V35C33 37.2091 31.2091 39 29 39H4C1.79086 39 0 37.2091 0 35V0Z"
      ></path>
    </mask>
    <path
      d="M0 0H33H0ZM37 35C37 39.4183 33.4183 43 29 43H4C-0.418278 43 -4 39.4183 -4 35H4H29H37ZM4 43C-0.418278 43 -4 39.4183 -4 35V0H4V35V43ZM37 0V35C37 39.4183 33.4183 43 29 43V35V0H37Z"
      fill="white"
      mask="url(#path-1-inside-1_8_19)"
    ></path>
    <path d="M12 6L12 29" stroke="white" stroke-width="4"></path>
    <path d="M21 6V29" stroke="white" stroke-width="4"></path>
  </svg>
</button>
{% if credit.etat == "en cours" %}
    <label class="switch active" onclick="activer(this,'{{ credit.id }}')">
        <input checked="" type="checkbox">
        <div class="slider">    
            <div class="circle">
                       <svg class="cross" xml:space="preserve" style="enable-background:new 0 0 512 512" viewBox="0 0 365.696 365.696" y="0" x="0" height="6" width="6" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <g>
                    <path data-original="#000000" fill="currentColor" d="M243.188 182.86 356.32 69.726c12.5-12.5 12.5-32.766 0-45.247L341.238 9.398c-12.504-12.503-32.77-12.503-45.25 0L182.86 122.528 69.727 9.374c-12.5-12.5-32.766-12.5-45.247 0L9.375 24.457c-12.5 12.504-12.5 32.77 0 45.25l113.152 113.152L9.398 295.99c-12.503 12.503-12.503 32.769 0 45.25L24.48 356.32c12.5 12.5 32.766 12.5 45.247 0l113.132-113.132L295.99 356.32c12.503 12.5 32.769 12.5 45.25 0l15.081-15.082c12.5-12.504 12.5-32.77 0-45.25zm0 0"></path>
                </g>
            </svg>
               <svg class="checkmark" xml:space="preserve" style="enable-background:new 0 0 512 512" viewBox="0 0 24 24" y="0" x="0" height="10" width="10" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <g>
                    <path class="" data-original="#000000" fill="currentColor" d="M9.707 19.121a.997.997 0 0 1-1.414 0l-5.646-5.647a1.5 1.5 0 0 1 0-2.121l.707-.707a1.5 1.5 0 0 1 2.121 0L9 14.171l9.525-9.525a1.5 1.5 0 0 1 2.121 0l.707.707a1.5 1.5 0 0 1 0 2.121z"></path>
                </g>
            </svg>
            </div>
        </div>
    </label>
{% else %}
    <label class="switch inactive" onclick="activer(this,'{{ credit.id }}')">
        <input type="checkbox">
        <div class="slider">
            <div class="circle">
                       <svg class="cross" xml:space="preserve" style="enable-background:new 0 0 512 512" viewBox="0 0 365.696 365.696" y="0" x="0" height="6" width="6" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <g>
                    <path data-original="#000000" fill="currentColor" d="M243.188 182.86 356.32 69.726c12.5-12.5 12.5-32.766 0-45.247L341.238 9.398c-12.504-12.503-32.77-12.503-45.25 0L182.86 122.528 69.727 9.374c-12.5-12.5-32.766-12.5-45.247 0L9.375 24.457c-12.5 12.504-12.5 32.77 0 45.25l113.152 113.152L9.398 295.99c-12.503 12.503-12.503 32.769 0 45.25L24.48 356.32c12.5 12.5 32.766 12.5 45.247 0l113.132-113.132L295.99 356.32c12.503 12.5 32.769 12.5 45.25 0l15.081-15.082c12.5-12.504 12.5-32.77 0-45.25zm0 0"></path>
                </g>
            </svg>
             <svg class="checkmark" xml:space="preserve" style="enable-background:new 0 0 512 512" viewBox="0 0 24 24" y="0" x="0" height="10" width="10" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <g>
                    <path class="" data-original="#000000" fill="currentColor" d="M9.707 19.121a.997.997 0 0 1-1.414 0l-5.646-5.647a1.5 1.5 0 0 1 0-2.121l.707-.707a1.5 1.5 0 0 1 2.121 0L9 14.171l9.525-9.525a1.5 1.5 0 0 1 2.121 0l.707.707a1.5 1.5 0 0 1 0 2.121z"></path>
                </g>
            </svg>
            </div>
        </div>
    </label>
{% endif %}

    </div>    
    </td>
    <!-- fin avnc -->


  </tr>

  {% else %}
  <tr>
      <td colspan="19">no records found</td>
  </tr>
  {% endfor %}
  <!-- Add more rows as needed -->
</tbody>

						</table>
					</div>
                    </div>
				</div>
			</div>
    </article>
</div>
<!-- contenu de la page -->
{% for credit in credits %}
<div class="modal fade" id="modal-{{ credit.id }}">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Liste des echeances</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" style="font-size:20px;color:red;">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <table class="table table-responsive-xl"  id="clients-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Date</th>
              
              <th>État</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for echeance in credit.echeances %}
            <tr>
              <td>{{ echeance.id }}</td>
              <td>{{ echeance.date.format('Y-m-d') }}</td>
              
              <td>{{ echeance.etat }}</td>
              <td style="width:20%;">

              <button onclick="toggleAccess(this, '{{ echeance.id }}')" class="Btn2">
  Pay
  <svg class="svgIcon" viewBox="0 0 576 512"><path d="M512 80c8.8 0 16 7.2 16 16v32H48V96c0-8.8 7.2-16 16-16H512zm16 144V416c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224H528zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm56 304c-13.3 0-24 10.7-24 24s10.7 24 24 24h48c13.3 0 24-10.7 24-24s-10.7-24-24-24H120zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24H360c13.3 0 24-10.7 24-24s-10.7-24-24-24H248z"></path></svg>
</button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<!--xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-->


<div class="modal fade" id="modal-sup-{{ credit.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form method="post" action="{{ path('app_credit_delete', {'id': credit.id}) }}">
                <div class="card2">
                    <div class="card2-content  text-center">
    <p class="card2-heading">Êtes-vous sûr de vouloir supprimer ce credit ?</p>
    <p class="card2-description">
        <strong>Montant de credit :</strong> {{ "ssx" }}<br>
        <strong>Agence :</strong> {{ "sss"}}<br>
        <!-- Ajoutez d'autres informations du compte selon vos besoins -->
    </p>
</div>

                    <div class="card2-button-wrapper">
                        <button class="card2-button secondary" data-dismiss="modal">Annuler</button>
                        <button class="card2-button primary">Confirmer la Suppression</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{# -------------------------------------------------------------------- #}
{% endfor %}


{% endblock %}


{% block autre_script %}

<script>
    function toggleAccess(element, echeanceId) {
        // Rediriger vers la route appropriée en fonction de l'état de la case à cocher
      
        var path =  "{{ path('echeance_payer', {'id': 'echId'}) }}" ;
        window.location.href = path.replace('echId', echeanceId);
    }
</script>

<script>  // Récupérer l'élément <li> par son ID
  var liAjouter = document.getElementById("ajouter");

  // Ajouter un gestionnaire d'événements de clic
  liAjouter.addEventListener("click", function() {
    // Rediriger l'utilisateur vers admin.php
    window.location.href = "{{ ('new') }}";
  });</script>

   <script>
    function activer(element,clientId) {
        var isChecked = element.querySelector('input').checked;
        var path = isChecked ? "{{ path('credit_activer', {'id': 'clientId'}) }}" : "{{ path('credit_desactiver', {'id': 'clientId'}) }}";
        window.location.href = path.replace('clientId', clientId);
    }
</script>
{% endblock %}


